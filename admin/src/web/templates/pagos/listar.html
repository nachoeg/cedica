{% extends "layouts/base.html" %}

{% block title %} Listado de Pagos {% endblock %}

{% block main %}

<h1>Listado de Pagos</h1>

<form method="GET">
    <input type="date" name="fecha_inicio" value="{{ fecha_inicio }}" placeholder="Fecha Inicio">
    <input type="date" name="fecha_fin" value="{{ fecha_fin }}" placeholder="Fecha Fin">
    
    <select name="tipo_pago_id">
        <option value="">Selecciona Tipo de Pago</option>
        {% for tipo in tipos_pago %}
            <option value="{{ tipo.id }}" {% if tipo_pago_id == tipo.id %}selected{% endif %}>
                {{ tipo.nombre }}
            </option>
        {% endfor %}
    </select>
    
    <button type="submit">Filtrar</button>
</form>

<table>
    <thead>
        <tr>
            <th>Tipo de Pago</th>
            <th>Monto</th>
            <th>Descripción</th>
            <th>
                <a href="{{ url_for('pago.pago_listar', orden='fechaDePago', asc=1 if not ascendente else 0, pagina=page) }}">
                    Fecha de Pago
                    {% if orden_campo == 'fechaDePago' %}
                        {% if ascendente %}
                            ↑
                        {% else %}
                            ↓
                        {% endif %}
                    {% endif %}
                </a>
            </th>
        </tr>
    </thead>
    <tbody>
        {% for pago in pagos_paginados.items %}
        <tr>
            <td>{{ pago.tipo_pago.nombre }}</td>
            <td>{{ pago.monto }}</td>
            <td>{{ pago.descripcion }}</td>
            <td>{{ pago.fechaDePago.strftime('%Y-%m-%d') }}</td>
        </tr>
        {% else %}
        <tr>
            <td colspan="4">No se encontraron pagos.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Paginación -->
<div class="pagination">
    {% for page in pagos_paginados.iter_pages() %}
        {% if page %}
            <a href="{{ url_for('pago.pago_listar', orden=orden_campo, asc=ascendente, pagina=page) }}">{{ page }}</a>
        {% else %}
            <span>…</span>
        {% endif %}
    {% endfor %}
</div>

{% endblock %}